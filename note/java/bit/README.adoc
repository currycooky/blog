= 位运算技巧与解析
:toc: left

== 位运算
位运算总共有三种运算方式，分别为：`&`、`|`、`^`、`~`，同时，还有一些移位操作，比如`<<`、`>>`，Java的话还有`>>>`
[cols="1,1,1"]
|===
|运算符|运算|解释

|&
|与
|两个对应的位都为1时为1

|^
|异或
|两个对应不同时则为1

|\|
|或
|只要有一个位为1则为1

|~
|取反
|将0转换为1，将1转换为0

|>>
|右移
|将二进制数字往右移动n位

|<<
|左移
|将二进制数字往左移动n位，也就是在数字右侧补n个0

|>>>
|无符号右移
|不会保留符号位，二进制数字符号位会变为0，所以只会返回正数

|===

=== 与（&）、或（|）、异或（^）
----
00011101
00000110

00000100 & // 只有第三位两个均为1
00011111 | // 只有有一个有1就为1
00011011 ^ // 两个不同才能为1
----

=== 取反
----
0001010110

1110101001 ~ // 所有位都互换
----

=== 右移
----
011 >> 2 = 00011
011 << 2 = 01100

// 假设第一位为符号位
101 >>  2 = 10001 // 保留符号位
101 >>> 2 = 00101 // 无视符号位，整体右移
----

== 进制计算方法
进制之间转换的方法都是相同的，以比较常用的十进制和二进制互转作为示例，其他进制的转换方式则省略。

=== 十进制转二进制
以十进制100为例，转化为二进制的过程如下：
....
100 / 2 = 50 ··· 0
50  / 2 = 25 ··· 0
25  / 2 = 12 ··· 1
12  / 2 = 6  ··· 0
6   / 2 = 3  ··· 0
3   / 2 = 1  ··· 1
1   / 2 = 0  ··· 1
....
最后的二进制结果是需要从下往上数，所以最终转化为的二进制为：`1100100`

如果是负数的话，也是先按照100来计算，但最后的二进制数字前面的符号位需要用1去填充，在Java中打印出来的-100的二进制为：`11111111111111111111111110011100`

=== 二进制转十进制
对于二进制 `1100100` 转换为十进制，其过程为：`1 * 2^6^ + 1 * 2^5^ + 0 * 2^4^ + 0 * 2^3^ + 1 * 2^2^ + 0 * 2^1^ + 0 * 2^0^`。其中，数字 `2` 表示的则是需要转换的进制数，例如，8则表示要转换成八进制；而数字 `2` 上的指数，则是当前数字所在位置 `-1` 。

== 位运算技巧
____
https://lfool.github.io/LFool-Notes/algorithm/%E4%BD%8D%E8%BF%90%E7%AE%97%E6%8A%80%E5%B7%A7.html
____

=== 大小写相互转换
----
// 转小写
(char) ('a' | ' ') = 'a'
(char) ('A' | ' ') = 'a'

// 转大写
(char) ('b' & '_') = 'B'
(char) ('B' & '_') = 'B'

// 大小写互转
(char) ('d' ^ ' ') = 'D'
(char) ('D' ^ ' ') = 'd'
----

=== 判断两个数是否异号
`(x ^ y) < 0`，true为异号

=== 不用临时变量交换两个数
----
int a = 1, b = 2;
a ^= b;
b ^= a;
a ^= b;
// 现在 a = 2, b = 1
----

=== 消除n的二进制中最后一位1
**`n & (n - 1)`**
----
int n = 5;
System.out.println(Integer.toBinaryString(n)); // 101
n = n & (n - 1);
System.out.println(Integer.toBinaryString(n)); // 100

int n = 4;
System.out.println(Integer.toBinaryString(n)); // 100
n = n & (n - 1);
System.out.println(Integer.toBinaryString(n)); // 0
----

=== 任意位置改为1或0
----
// 将第 i 位标记为 1
used |= 1 << i;

// 将第 i 位标记为 0
used ^= 1 << i;
----

----
int n = 10;
System.out.println(Integer.toBinaryString(n)); // 1010
n ^= 1 << 1;
System.out.println(Integer.toBinaryString(n)); // 1000
----

----
int n = 10;
System.out.println(Integer.toBinaryString(n)); // 1010
n |= 1 << 2;
System.out.println(Integer.toBinaryString(n)); // 1110
----

=== 判断某一位置是否为0
`((used >> i) & 1) == 1`

----
int n = 10;
System.out.println(Integer.toBinaryString(n)); // 1010
System.out.println(((n >> 2) & 1)); // 0
----